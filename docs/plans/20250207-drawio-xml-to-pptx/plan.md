---
Created: 2025-02-07
Owner: x4066x
Status: draft
---

# 実装計画: Drawio XML → Drawio → 編集可能なPPTX

## Goal

AIが出力したDrawio形式のXMLを、Drawioファイルに変換し、さらに編集可能なPPTXとして出力する一連のパイプラインを実現する。

## Background / Motivation

- AI（LLM）に図の内容をXMLで直接出力させ、手でDrawioを触らずに図を作成・更新したい。
- 得られた図をそのままPPTXに載せ、スライド上で編集可能な形（図形として）にしたい。
- パイプラインは「Saved pptx」と表示しても、入力XMLの構造によっては図形が1つも描画されない空のPPTXが出力される場合がある。そのため、**XMLがPPTXに正しく反映されたかの検証**と、**出力の見た目を確認するプレビュー**を計画に含める。

## Constraints

- DrawioのXML仕様（mxGraphModel 等）に沿った変換を行う。既存のDrawioエディタで開ける形式を出力する。
- PPTX出力は、図形（Shape）として編集可能であること。単なる画像の貼り付けは対象外とする。
- 使用言語・ランタイム・ライブラリに制約は設けない。実装しやすい技術でよい（DR-001〜003は実装時に判断してよい）。
- Python を選ぶ場合: パッケージ・実行環境は **uv** を使用する。
- Node.js を選ぶ場合: ランタイム管理は **Volta** を使用する。

## Definition of Done

- [ ] AIが出力したDrawio互換XMLを入力として受け取り、`.drawio` として保存・開ける形式に変換できる
- [ ] 変換済みDrawio（または同XML）から、編集可能な図形を含むPPTXを生成できる
- [ ] 生成したPPTXをPowerPoint等で開き、図形の移動・リサイズ・テキスト編集ができる
- [ ] 上記一連の流れ（XML → Drawio → PPTX）を実行できるCLIまたはAPIが存在する
- [ ] **検証**: 生成PPTXにXML由来の図形が含まれることを確認できる手段がある（図形0件の検知・警告、またはテストでのアサートなど）
- [ ] **プレビュー**: 出力の見た目を確認する手段がある（プレビュー画像の生成、CLIでのスライド/図形一覧表示、または手動でPowerPointで開いて確認する手順の明記のいずれか）

## Assumptions

- 「AIが出力するXML」は、Drawioの mxGraphModel に準拠したXMLであると仮定する（スキーマ検証の有無はDRで判断）。
- 複数ページ・複雑なレイアウトは初期スコープ外とし、1ページ・基本的な図形・テキストを優先する。

## Decision Required

（実装時に判断。事前の指定がなければ実装者に委ねる）

| ID | 内容 | 選択肢 | Priority |
|----|------|--------|----------|
| DR-001 | 実装言語・ランタイム | Python / Node.js / その他 | P0 |
| DR-002 | Drawio→PPTXの実装方針 | 既存ライブラリ（python-pptx等）で図形生成 / 中間形式を経由 / その他 | P1 |
| DR-003 | AI出力XMLの検証 | スキーマ・バリデーションを行う / 行わずベストエフォートで変換 | P1 |
| DR-004 | プレビュー方法 | 手動でPowerPointで開く手順をドキュメント化 / CLIでスライド・図形一覧を表示 / プレビュー画像を自動生成 | P2 |

## References

- （プロジェクト内に既存ドキュメントがあれば追記）
